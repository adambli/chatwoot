trigger:
- main

pool:
  vmImage: 'ubuntu-latest'

steps:
- checkout: self
  submodules: true

- script: |
    sudo apt-get update
    sudo apt-get install -y ruby-full
    sudo apt-get install -y nodejs
    sudo apt-get install -y yarn
    gem install bundler
  displayName: 'Install Ruby, Node.js, Yarn, and Bundler'

- script: |
    git clone https://github.com/chatwoot/chatwoot.git
    cd chatwoot
    bundle install
    yarn install
  displayName: 'Clone repository and install dependencies'

- script: |
    cp .env.example .env
    # Add commands to configure .env as required
  displayName: 'Setup Environment Variables'

- script: |
    docker-compose -f docker-compose.production.yaml build
  displayName: 'Build Docker images'

